<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì†Œì‹ ìˆ˜ì • - ë¯¸ë˜ì—°ëŒ€ë‹¹</title>
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --brand-blue: #007acc; --brand-navy: #1d458b; }
        body { font-family: 'Pretendard', sans-serif; margin: 0; background: #f8f9fa; }
        .write-wrap { max-width: 900px; margin: 60px auto; padding: 40px; background: #fff; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); }
        input, select, textarea { width: 100%; padding: 15px; margin-bottom: 20px; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; box-sizing: border-box; }
        textarea { height: 400px; line-height: 1.6; }
        .btn-update { background: var(--brand-blue); color: white; border: none; padding: 20px; width: 100%; font-size: 18px; font-weight: bold; border-radius: 12px; cursor: pointer; }
    </style>
</head>
<body>
    <div class="write-wrap">
        <h2 style="color:var(--brand-navy)">ğŸ“ ì†Œì‹ ìˆ˜ì •í•˜ê¸°</h2>
        <select id="category">
            <option>ë…¼í‰Â·ë¸Œë¦¬í•‘</option><option>ëª¨ë‘ë°œì–¸</option><option>ë³´ë„ìë£Œ</option><option>ê³µì§€ì‚¬í•­</option>
        </select>
        <input type="text" id="title" placeholder="ì œëª©">
        <textarea id="content" placeholder="ë‚´ìš©"></textarea>
        <button class="btn-update" onclick="updateNews()">ìˆ˜ì • ì™„ë£Œ</button>
    </div>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const newsId = urlParams.get('id');

        // 1. ê¸°ì¡´ ë‚´ìš© ë¶ˆëŸ¬ì™€ì„œ ì±„ìš°ê¸°
        window.onload = async () => {
            const res = await fetch(`/api/news/${newsId}`);
            const data = await res.json();
            document.getElementById('title').value = data.title;
            document.getElementById('category').value = data.category;
            document.getElementById('content').value = data.content;
        };

        // 2. ìˆ˜ì •ëœ ë‚´ìš© ì„œë²„ë¡œ ë³´ë‚´ê¸°
        async function updateNews() {
            const title = document.getElementById('title').value;
            const category = document.getElementById('category').value;
            const content = document.getElementById('content').value;

            const res = await fetch(`/api/news/${newsId}`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ title, category, content })
            });

            if (res.ok) {
                alert("ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.");
                location.href = `/news-detail.html?id=${newsId}`;
            }
        }
    </script>
</body>
</html>
